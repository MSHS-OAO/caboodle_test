---
title: "Microsoft SQl Server Test"
output: html_document
---

```{r setup}
library(DBI)
library(odbc)
library(readxl)

#  con_caboodle <- dbConnect(odbc(),
 #                 Driver = "SQLServer",
  #                Server = "SEPIBOJP016001",
   #               UID = "kweons01",
    #              PWD = "Pasword01#PasPasword01#Pas",
     #             Port = 1433)              
#print(con_caboodle)
#print("Caboodle was succesful")
```
```{r}
con_hh <- dbConnect(odbc(),
                Driver = "SQLServer",
               Server = "10.2.42.69",
              UID = "kweons01",
             PWD = "Pasword01#PasPasword01#Pas",
            Port = 1433)     
 print(con_hh)
 print("Hand hygiene was successful")
 dbGetQuery(con_hh, "SELECT * FROM qidm_dev.dbo.amb_hand_hygiene_comp")
  
 test <- read_xlsx("/nfs/data/Applications/Ambulatory/master_amb_mapping.xlsx")
 print(test)
```
```{r}
scheduling_data_raw <- as.data.frame(readRDS("/nfs/data/Applications/Ambulatory/Data_Updated/historical_data.rds")) %>%
  filter(!is.na(Campus)) %>%
  filter(Campus %in% c("NETWORK","MSM","MSH-MSDFP","ONCOLOGY","MSW","MSBI","MSUS","MSH- AMBULATORY CARE","MSDD")) %>%
  filter(Appt.Status == "Arrived") %>%
  filter(Appt.DateYear >= as.Date("2022-01-01"), Appt.DateYear <= as.Date("2022-08-01")) 
 
 print(sort(unique(scheduling_data_raw$Appt.DateYear)))
```
